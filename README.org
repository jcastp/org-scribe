#+TITLE: org-scribe - Creative Writing Toolkit for Org-mode
#+AUTHOR: Javier Castilla
#+EMAIL: jcastp@pm.me

* Overview

=org-scribe= is a comprehensive, batteries-included toolkit for novelists, short story writers, and creative writers working in Emacs Org-mode. It provides everything you need from project creation to final export: templates, writing environments, word counting, progress tracking, and powerful search capabilities.

* Features

** Complete Workflow

*** Project Creation & Templates
- *Create Novel Projects*: Generate complete project structure from templates with a single command
- *Scene Insertion*: Insert pre-formatted scene templates with metadata properties
- *Chapter Insertion*: Add chapter templates with word count tracking
- *Template Customization*: Edit templates to match your workflow
- *Bilingual Support*: English and Spanish templates included
- *Git Integration*: Projects automatically initialized with git

*** Writing Tools
- *Character Linking*: ID-based links between scenes and character profiles
  - Automatic ID creation for captured characters
  - Click character names in scene properties to jump to full profiles
  - Menu-based character selection for scene properties
  - Searches work with both plain text and ID links
  - Stable links that survive character name changes
- *Character Relationships*: Track and visualize character relationships
  - Structured relationship data (type, strength, sentiment)
  - Interactive relationship management
  - Multiple visualization formats (DOT graphs, ASCII trees, tables)
  - Graphviz integration for professional network graphs
  - Filter by relationship strength
  - Export relationship visualizations
- *Location Linking*: ID-based links between scenes and location profiles
  - Same linking system for locations/settings
  - Jump from scene to detailed location descriptions
- *Plot Thread Linking*: ID-based links for plot threads and subplots
  - Track main plot and subplots across your novel
  - Timeline visualization showing plot distribution
  - Health reports identify plot issues (gaps, low coverage, abandoned threads)
  - Statistics showing plot thread presence across chapters
- *Column View Enhancement*: Clean property display in org-mode column view
  - Automatically strips ID link syntax in column view
  - Shows "Alex" instead of "[[id:abc123][Alex]]"
  - Works with all linked properties (PoV, Characters, Plot, Location)
- *Word Counting*: Accurate word counting that excludes Org-mode metadata (comments, properties, drawers)
- *Progress Tracking*: Daily word count tracking with org-tracktable integration
- *Writing Modes*: Four mutually exclusive modes for different workflows:
  - Distraction-free writing mode
  - Focus mode with buffer narrowing
  - Project navigation mode (with treemacs and imenu-list)
  - Three-pane editing layout
- *Search Functions*: Find scenes by POV, character, location, or plot keywords using org-ql (handles ID links)
- *Dictionary Tools*: Spanish RAE dictionary API, synonym lookup, and translation support
- *Capture System*: Project-aware note capture that finds the right notes file
- *Export Filters*: Scene break replacement for different export backends
- *Hydra Menu*: Unified keyboard-driven menu for quick access to all functions

** Bilingual Support

Full support for English/Spanish bilingual writing:
- Spanish RAE dictionary integration
- WordReference synonym lookup
- Automatic language detection
- Bilingual project structure support (notes/notas directories)

* Installation

** Dependencies

*** Required Packages

- Emacs 29.1+
- org-mode 9.6+
- [[https://github.com/alphapapa/org-ql][org-ql]] (0.8+)
- [[https://github.com/joostkremers/writeroom-mode][writeroom-mode]] (3.7+)
- [[https://codeberg.org/jcastp/org-context-extended][org-context-extended]]
- [[https://codeberg.org/jcastp/org-tracktable][org-tracktable]]

*** Optional Packages

- [[https://github.com/minad/consult][consult]] - For theme switching in writing modes
- [[https://github.com/protesilaos/fontaine][fontaine]] - For font preset management
- [[https://github.com/Alexander-Miller/treemacs][treemacs]] - For project navigation mode
- [[https://github.com/bmag/imenu-list][imenu-list]] - For document outline in editing modes
- [[https://github.com/guess-language/guess-language.el][guess-language]] - For automatic language detection
- [[https://github.com/lorniu/gt.el][gt]] - For translation support
- [[https://github.com/SavchenkoValeriy/emacs-powerthesaurus][powerthesaurus]] - For English thesaurus
- [[https://github.com/nobiot/org-remark][org-remark]] - For text annotations

** From Source

Clone the repository:

#+begin_src sh
git clone https://codeberg.org/jcastp/org-scribe ~/.emacs.d/org-scribe
#+end_src

Add to your Emacs configuration:

#+begin_src emacs-lisp
(add-to-list 'load-path "~/.emacs.d/org-scribe")
(require 'org-scribe)

;; Optional: Enable automatically in org-mode
(add-hook 'org-mode-hook #'org-scribe-mode)

;; Optional: Set up recommended keybindings
(org-scribe-setup)
#+end_src

** Using use-package (Recommended)

#+begin_src emacs-lisp
(use-package org-scribe
  :vc (:url "https://codeberg.org/jcastp/org-scribe"
       :branch "main"
       :rev :newest)
  :after org
  :hook (org-mode . org-scribe-mode)
  :config
  ;; Customize settings
  (setq org-scribe-env-work-theme 'poet)
  (setq org-scribe-env-normal-theme 'ef-deuteranopia-dark)
  (setq org-scribe-stories-directory "~/writing/exercises")

  ;; Keybindings
  (global-set-key (kbd "<f8> <f8>") 'hydra-org-scribe/body))
#+end_src

* Quick Start

** Create Your First Novel Project

1. Install the package and dependencies
2. Run =M-x org-scribe-create-novel-project=
3. Choose a directory and enter your novel title
4. Start writing in the generated =novel.org= file!

** Working in an Existing Project

1. Open an org-mode file in your project
2. Press =<f8> <f8>= to open the hydra menu
3. Try a writing mode: press =w= for distraction-free mode
4. Use =n= to count words in the current section
5. Insert scenes with =S= or chapters with =C=

* Usage

** Project Creation

*** Create a New Novel Project

=M-x org-scribe-create-novel-project=

This creates a complete project structure:

#+begin_example
MyNovel/
├── README.org              # Project overview and status
├── novel.org              # Main manuscript with progress tracking
├── revision.org           # Revision tracking
├── writing-journal.org    # Reflective writing journal
├── objects/                  # Planning documents
│   ├── characters.org
│   ├── locations.org
│   ├── plot.org
│   ├── timeline.org
│   └── objects.org
└── notes/                 # Research and notes
    ├── notes.org
    └── research.org
#+end_example

The project includes:
- Pre-configured word count tracking
- Scene and chapter templates
- Progress tracking tables
- Export configurations for LaTeX, ODT, HTML, EPUB
- Git repository initialization

*** Insert Scene or Chapter

While working in your manuscript:

- =M-x org-scribe-insert-scene= or =F8 F8 s=: Insert a scene with metadata properties (PoV, Characters, Plot, Location, etc.)
- =M-x org-scribe-insert-chapter= or =F8 F8 c=: Insert a chapter heading with word count property

*** Quick Project File Access

=M-x org-scribe-open-project-file= or =F8 F8 o=

Opens project files with completion (novel.org, objects/characters.org, notes/notes.org, etc.)

*** Customize Templates

=M-x org-scribe-edit-templates=

Opens the template directory for editing. Customize templates to match your workflow!

** Writing Modes

*** Distraction-Free Mode (=org-scribe/writing-env-mode=)

Press =F8 F8 m= or use the hydra menu.

Changes:
- Switches to writing theme
- Changes font to writing preset
- Activates writeroom-mode
- Shows line numbers

*** Focus Mode (=org-scribe/writing-env-mode-focus=)

Press =F8 F8 f= or use the hydra menu.

Like distraction-free mode, but also narrows to the current org section.

*** Project Navigation Mode (=org-scribe/project-mode=)

Opens treemacs (file tree) and imenu-list (document outline) for easy navigation.

*** Editing Mode (=org-scribe/editing-mode=)

Three-pane layout:
- Left: Document outline (imenu-list)
- Center: Main document
- Right: Notes file (org-remark annotations)

** Word Counting

*** Count Words in Selection

=M-x org-context-count-words= or press =F8 F8 w= in hydra

*** Add Word Count Properties

=M-x org-scribe/ews-org-count-words= or press =F8 F8 a= in hydra

Adds a =WORDCOUNT= property to each heading.

*** Generate Word Count Table with Progress

Add this to your org file:

#+begin_example
#+BEGIN: org-generate-wordcount-table
#+END:
#+end_example

Update with =C-c C-c= on the #+BEGIN line.

This generates a comprehensive table showing:
- Hierarchical heading structure (Acts, Chapters, Scenes)
- Wordcount (from =WORDCOUNT= property)
- Objective (from =WORD-OBJECTIVE= property, when set)
- Progress (auto-calculated percentage)

**Example output:**

#+begin_example
| Heading                     | Wordcount | Objective | Progress |
|-----------------------------+-----------+-----------+----------|
| - Act I                     |       711 |      5000 |      14% |
| -- Chapter 1                |       447 |      1500 |      30% |
| --- Scene 1 - The Alarm     |       167 |       500 |      33% |
| --- Scene 2 - Coffee Shop   |       280 |       500 |      56% |
#+end_example

*** Set Word Objectives for Progress Tracking

Add the =WORD-OBJECTIVE= property to your Acts, Chapters, or Scenes to enable automatic progress calculation:

#+begin_example
* Act I :ignore:
:PROPERTIES:
:WORDCOUNT: 711
:WORD-OBJECTIVE: 5000
:END:
#+end_example

When you update the word count table (with =C-c C-c= on the #+BEGIN line), progress percentages will be automatically calculated for any section that has a =WORD-OBJECTIVE= property.

** Character Linking

*** Overview

Link character names in scene properties directly to their full profiles in =objects/characters.org=. Click on character names to jump to detailed character information!

*** Quick Start

For existing projects:
1. =M-x org-scribe/setup-character-links= or press =F8 F8 C s=
2. Adds unique IDs to all characters
3. Optionally converts existing scenes to use links

For new characters:
- Characters created with =org-scribe/capture-character= (F8 F8 h) automatically get IDs
- No manual setup needed!

*** Setting Scene Characters

*Set PoV Character* (=F8 F8 C p=):
1. Position on scene heading
2. Press =F8 F8 C p=
3. Select character from menu
4. PoV property updated with ID link

*Set Scene Characters* (=F8 F8 C c=):
1. Position on scene heading
2. Press =F8 F8 C c=
3. Select characters one by one
4. Press RET to finish
5. Characters property updated with ID links

*** Navigation

*Jump to PoV Character* (=F8 F8 C j=):
- Instantly jump from scene to PoV character's full profile
- Press =C-c &= to return to scene

*Click Any Character Link*:
- Position cursor on character name in properties
- Press =C-c C-o= (or click with mouse)
- Jumps to character profile

*** How It Works

Scene properties change from plain text to ID links:

Before:
#+begin_example
:PoV: Alex
:Characters: Alex, Sam
#+end_example

After:
#+begin_example
:PoV: [[id:char-alex-rivera-001][Alex]]
:Characters: [[id:char-alex-rivera-001][Alex]], [[id:char-sam-chen-002][Sam]]
#+end_example

Benefits:
- Click to navigate to character profiles
- Links survive character renames
- Searches still work (automatic extraction)
- Quick reference while writing

*** Updating Link Display Names

When you rename a character in =objects/characters.org=, the ID links still work (they're ID-based), but the display text shows the old name. Update the display names to match your current database:

*Update Current Scene* (=F8 F8 C u=):
- Updates character link names in the current scene only

*Update All Scenes* (=F8 F8 C U=):
- Updates character link names throughout the entire manuscript
- Scans all scenes and refreshes display text from database

*Example Workflow*:
1. Rename "Alex Rivera" to "Alexandra Rivera" in =objects/characters.org=
2. Press =F8 F8 C U= (or =M-x org-scribe/update-all-character-link-names=)
3. All scenes updated: =[[id:char-alex-001][Alexandra Rivera]]=
4. Links still work, now with correct names!

*Update All Link Types* (=F8 F8 U=):
- Updates characters, locations, AND plot threads all at once
- Convenient after bulk renaming in planning files
- Available from main menu (=F8 F8 U=)

*** Character Linking Hydra Menu

Press =F8 F8 C= to access:

*Character Linking:*
- =p= - Set PoV character
- =c= - Set scene characters
- =j= - Jump to PoV character
- =l= - Link current scene
- =L= - Link all scenes
- =i= - Add IDs to characters
- =u= - Update link names (current scene)
- =U= - Update all link names
- =s= - Setup linking system

*Relationships:*
- =a= - Add relationship
- =r= - Remove relationship
- =v= - View character relationships
- =V= - View all relationships
- =R= - Setup relationships

*Visualization:*
- =g= - Insert graph block

See [[file:CHARACTER-LINKING.org][Character Linking Guide]] for complete documentation.

** Character Relationships

*** Overview

Track and visualize the relationships between your characters. The relationship system uses structured data (type, strength, sentiment) stored in character properties, enabling powerful analysis and visualization of your character network.

*** Quick Start

For existing projects:
1. =M-x org-scribe/setup-character-relationships= or press =F8 F8 C R=
2. Adds =RelationshipsData= property to all characters
3. Start adding relationships!

*** Adding Relationships

*Add a Relationship* (=F8 F8 C a= or =M-x org-scribe/add-relationship=):
1. Select source character (the character who has the relationship)
2. Select target character (the character they're related to)
3. Choose relationship type (mentor, rival, friend, family, lover, enemy, ally, etc.)
4. Set strength (1-5, where 1=acquaintance, 5=central to their life)
5. Choose sentiment (positive, negative, neutral, complex)

*Example*:
- From: Alice
- To: Bob
- Type: mentor
- Strength: 5
- Sentiment: positive
- Result: "Alice → Bob (mentor, strength 5, positive)"

*Remove a Relationship* (=F8 F8 C r= or =M-x org-scribe/remove-relationship=):
1. Select character to modify
2. Choose which relationship to remove

*** Viewing Relationships

*View Single Character* (=F8 F8 C v= or =M-x org-scribe/show-character-relationships=):
- Select a character
- Displays ASCII tree showing all their relationships
- Legend explains sentiment symbols (+/−/~/·)

*View All Relationships* (=F8 F8 C V= or =M-x org-scribe/show-all-relationships=):
- Shows complete relationship table for entire project
- Sortable org-mode table format
- See all connections at a glance

*** Visualizing Relationships

*Insert Relationship Graph* (=F8 F8 C g= or =M-x org-scribe/insert-relationship-block=):

Creates a dynamic block that generates visualizations. Choose from three formats:

*1. DOT Graph (Graphviz)*:
#+begin_example
#+BEGIN: character-relationships :format dot
#+END:
#+end_example

Press =C-c C-c= to generate a professional network graph showing:
- Nodes for each character
- Directed edges showing relationship direction
- Edge color indicates sentiment (green=positive, red=negative, purple=complex, gray=neutral)
- Edge thickness indicates relationship strength
- Labels show relationship type and strength

Requires Graphviz installed: =sudo apt install graphviz=

*2. ASCII Tree*:
#+begin_example
#+BEGIN: character-relationships :format ascii
#+END:
#+end_example

Generates text-based visualization:
#+begin_example
Alice
  ├─(mentor,+)─> Bob
  ├─(rival,−)──> Charlie
  └─(friend,+)─> Dana
#+end_example

*3. Table Format*:
#+begin_example
#+BEGIN: character-relationships :format table
#+END:
#+end_example

Creates an org-mode table of all relationships.

*** Advanced Visualization Options

*Filter by Strength*:
Only show strong relationships:
#+begin_example
#+BEGIN: character-relationships :format dot :filter-strength 4
#+END:
#+end_example

*Single Character Network*:
Show only one character's connections (ego network):
#+begin_example
#+BEGIN: character-relationships :format dot :character "Alice"
#+END:
#+end_example

*Custom Output File*:
Save graph to specific file:
#+begin_example
#+BEGIN: character-relationships :format dot :image-file "characters.svg" :image-format svg
#+END:
#+end_example

Supported image formats: =png= (default), =svg=, =pdf=

*** Relationship Data Structure

Relationships are stored in the =:RelationshipsData:= property:

#+begin_example
* Alice Rivera
:PROPERTIES:
:ID: char-alice-001
:RelationshipsData: [[id:char-bob-002][Bob]](mentor,5,positive); [[id:char-charlie-003][Charlie]](rival,3,negative)
:END:
#+end_example

This format:
- Uses ID links (stable across renames)
- Stores type, strength, sentiment for each relationship
- Semicolon-separated for multiple relationships
- Human-readable and editable

*** Relationship Types

Common relationship types include:
- =mentor/mentee= - Teaching/learning relationship
- =friend= - Friendly relationship
- =rival/opponent= - Competitive relationship
- =family= - Family connections (parent, child, sibling)
- =lover/spouse= - Romantic relationships
- =ally= - Working together toward common goal
- =enemy= - Active opposition
- =colleague/partner= - Professional relationship
- =superior/subordinate= - Hierarchical relationship

Custom types are supported - use any text that describes the relationship!

*** Use Cases

*Character Network Analysis*:
- Identify isolated characters (may need more connections)
- Find central characters (hub of the network)
- Visualize character clusters and groups

*Story Planning*:
- Ensure main character has sufficient relationships
- Track relationship evolution throughout story
- Identify relationship conflicts and alliances

*Consistency Checking*:
- View all relationships in table format
- Ensure relationship strengths match their importance in story
- Verify relationship symmetry (if Alice considers Bob a rival, does Bob reciprocate?)

** Plot Thread Linking and Analysis

*** Overview

Track your main plot and subplots across your novel using ID-based links. The plot thread system provides visualization, health monitoring, and gap detection to ensure plot threads are properly developed throughout your story.

*** Quick Start

For existing projects:
1. =M-x org-scribe/setup-plot-thread-links= or press =F8 F8 P s=
2. Adds unique IDs to all plot threads in =objects/plot.org=
3. Optionally converts existing scenes to use links

For new plot threads:
- Plot threads created with =org-scribe/capture-plot-thread= automatically get IDs
- No manual setup needed!

*** Setting Scene Plot Threads

*Set Scene Plot Threads* (=F8 F8 P p=):
1. Position on scene heading
2. Press =F8 F8 P p=
3. Select plot threads one by one (main plot, subplots)
4. Press RET to finish
5. Plot property updated with ID links

*Jump to Plot Thread* (=F8 F8 P j=):
- Jump from scene to plot thread definition
- Press =C-c &= to return to scene

*** Plot Thread Analysis

**** Timeline Visualization

Generate a timeline table showing which plot threads appear in which scenes:

1. Add to your manuscript or a separate analysis file:
   #+begin_example
   #+BEGIN: plot-thread-timeline
   #+END:
   #+end_example

2. Press =C-c C-c= on the #+BEGIN line to generate/update

**Example output:**
#+begin_example
| Scene              | Chapter   | Main Plot | Romance Subplot | Mystery Subplot |
|--------------------+-----------+-----------+-----------------+-----------------|
| Scene 1 - Opening  | Chapter 1 | ●         |                 | ●               |
| Scene 2 - Meeting  | Chapter 1 | ●         | ●               |                 |
| Scene 3 - Discovery| Chapter 2 | ●         |                 | ●               |
#+end_example

The ● symbol shows where each plot thread appears, making it easy to spot:
- Threads that appear too frequently (overwhelming)
- Threads with large gaps (forgotten subplots)
- Threads that only appear once (abandoned story lines)

**** Health Report

Generate a comprehensive health report for all plot threads:

=M-x org-scribe/plot-thread-report= or press =F8 F8 P r=

This generates a buffer showing:
- Total plot threads and scenes
- Per-thread analysis:
  - Scene count and coverage percentage
  - First and last appearance
  - Warnings for potential issues

**Warning indicators:**
- ⚠️ *Low coverage* (<30% of scenes) - thread may be underdeveloped
- ⚠️ *Large gap* (>5 consecutive scenes) - thread may be forgotten
- ⚠️ *Single scene* - thread appears only once, might need expansion

**Example report:**
#+begin_example
* Summary
- Total plot threads: 3
- Total scenes: 12
- Scenes with plot threads: 12

* Thread Details

** ✓ Main Plot
:PROPERTIES:
:ID: plot-main-001
:END:

- Scenes: 12 of 12 (100.0%)
- First appearance: Scene 1 - Opening (Chapter: Chapter 1)
- Last appearance: Scene 12 - Finale (Chapter: Chapter 4)

** ⚠️ Romance Subplot
:PROPERTIES:
:ID: plot-romance-002
:END:

- Scenes: 3 of 12 (25.0%)
- First appearance: Scene 2 (Chapter: Chapter 1)
- Last appearance: Scene 10 (Chapter: Chapter 3)

*Warnings:*
- ⚠️ Low coverage (25.0%)
- ⚠️ Gap of 6 scenes
#+end_example

**** Quick Statistics

Get quick statistics in the minibuffer:

=M-x org-scribe/plot-thread-stats= or press =F8 F8 P S=

Shows:
- Total threads
- Total scenes with plot thread tracking
- Average thread coverage
- Threads with warnings

*** How It Works

Scene properties change from plain text to ID links:

Before:
#+begin_example
:Plot: Main Plot, Romance
#+end_example

After:
#+begin_example
:Plot: [[id:plot-main-001][Main Plot]], [[id:plot-romance-002][Romance]]
#+end_example

Benefits:
- Click to navigate to plot thread details in =objects/plot.org=
- Links survive plot thread renames
- Timeline and health reports automatically track all scenes
- Identify plot issues before they become problems

*** Plot Thread Linking Hydra Menu

Press =F8 F8 P= to access:
- =p= - Set scene plot threads
- =j= - Jump to plot thread
- =l= - Link current scene
- =L= - Link all scenes
- =i= - Add IDs to threads
- =u= - Update link names (current scene)
- =U= - Update all link names
- =s= - Setup linking system
- =t= - Timeline table (shows how to insert)
- =r= - Health report
- =S= - Statistics

Note: Like character links, you can update plot thread display names after renaming threads in =objects/plot.org= using =F8 F8 P U= or the unified =F8 F8 U=.

*** Best Practices

1. *Use Descriptive Names*: "Main Plot: Hero's Journey" instead of just "A-plot"
2. *Review Health Reports Regularly*: Check for gaps and low coverage during revisions
3. *Balance Plot Threads*: Aim for main plot in 80-100% of scenes, subplots in 30-60%
4. *Track Timeline*: Update timeline table periodically to visualize distribution
5. *Fix Gaps Early*: If a subplot has a gap >5 scenes, consider adding a scene or removing the thread

** Character Timeline

*** Overview

Track character appearances across your novel using a visual timeline. See at a glance which characters appear in which scenes, who has the PoV, and identify coverage gaps.

*** Quick Start

Character timeline uses the existing character properties you're already setting:

1. Tag scenes with character information (using ID links or plain text):
   #+begin_example
   :PoV: [[id:char-alice-001][Alice]]
   :Characters: [[id:char-alice-001][Alice]], [[id:char-bob-002][Bob]]
   #+end_example

2. Add timeline block to your =novel.org= (already in template):
   #+begin_example
   #+BEGIN: character-timeline
   #+END:
   #+end_example

3. Press =C-c C-c= on the #+BEGIN line to generate/update

*** Reading the Timeline

**Symbols**:
- ◆ = Character is the Point of View character (implies presence)
- ● = Character is present in the scene (not PoV)
- (blank) = Character is not present

**Example**:
#+begin_example
| Scene              | Chapter   | Alice | Bob | Charlie |
|--------------------+-----------+-------+-----+---------|
| Scene 1 - Opening  | Chapter 1 | ◆     | ●   |         |
| Scene 2 - Meeting  | Chapter 1 | ●     |     | ●       |
| Scene 3 - Conflict | Chapter 2 | ◆     | ●   | ●       |
#+end_example

**Interpretation**:
- Alice: PoV in scenes 1 and 3, present (not PoV) in scene 2
- Bob: Present in scenes 1 and 3, absent from scene 2
- Charlie: Appears in scenes 2 and 3, absent from scene 1

*** Use Cases

1. **Character Coverage**: "Is my protagonist appearing enough?"
   - Check main character appears in 80-100% of scenes
   - Identify extended absences

2. **PoV Balance** (Multi-POV Novels): "Am I favoring one viewpoint too much?"
   - Scan ◆ symbols across characters
   - Ensure balanced distribution
   - Verify alternating pattern (if desired)

3. **Gap Detection**: "Did I forget about this character?"
   - Spot large gaps (>10 scenes without appearance)
   - Identify forgotten supporting characters
   - Plan reintroduction scenes

4. **Character Arc Tracking**: "Is the character development well-distributed?"
   - See all scenes featuring specific character
   - Verify arc scenes span appropriate chapters
   - Check character appears in key moments

5. **Relationship Tracking**: "When do these characters interact?"
   - Find rows where both characters have symbols
   - Frequency of joint appearances
   - Last interaction

*** How It Works

The timeline automatically:
- Extracts character names from `:PoV:` and `:Characters:` properties
- Handles both plain text and ID links (extracts display text)
- Shows only characters who appear in at least one scene
- Sorts characters alphabetically for easy location
- Distinguishes PoV from other appearances

If a character is PoV and also in Characters property, only ◆ is shown (PoV implies presence).

*** Best Practices

1. **Consistent Tagging**: Always set both PoV and Characters properties for complete tracking

2. **Main vs. Supporting**:
   - Main characters: Should appear in 60-100% of scenes
   - Supporting characters: 20-50% coverage is normal
   - Minor characters: <20% is fine

3. **Update Regularly**:
   - After writing each chapter
   - Before planning next chapter (identify gaps)
   - During revision (overall balance check)

4. **PoV Distribution** (Multi-POV):
   - Aim for minimum scenes per PoV character per act
   - Check PoV distribution is intentional
   - Avoid accidental PoV dominance

5. **Balance with Plot Timeline**:
   - Character timeline shows *who*
   - Plot timeline shows *what*
   - Use both for complete picture

*** Example Workflow

**Scenario**: Revising Act II, checking supporting character "Eve"

1. Open =novel.org= in Progress Tracking section
2. Find Character Timeline table
3. Press =C-c C-c= to update
4. Scan Eve column:
   #+begin_example
   | Scene 5  | Ch 3 |   |   | ● |   |
   | Scene 6  | Ch 3 |   |   |   |   |  ← Gap starts
   | Scene 7  | Ch 4 |   |   |   |   |
   | Scene 8  | Ch 4 |   |   | ● |   |  ← Gap ends (3 scenes)
   #+end_example
5. Notice: Eve has a 3-scene gap (scenes 6-7)
6. Decision: Add Eve to Scene 7 for continuity
7. Update Scene 7 properties:
   #+begin_example
   :Characters: Alice, Bob, Eve
   #+end_example
8. Re-generate timeline to verify

**Result**: Eve's gap reduced, better presence continuity

** Search Functions

All search functions are available via the hydra menu (=F8 F8=):

- =1=: Find scenes by POV character
- =2=: Find scenes with character
- =3=: Find scenes by plot keyword
- =4=: Find scenes by location
- =5=: Find all TODO items in project

These searches use org properties and work with both plain text and ID links:

#+begin_example
* Chapter 1
:PROPERTIES:
:PoV: [[id:char-alice-001][Alice]]
:Characters: [[id:char-alice-001][Alice]], [[id:char-bob-002][Bob]]
:Location: Coffee Shop
:Plot: First meeting
:END:
#+end_example

Searching for "Alice" finds this scene even with ID links!

** Dictionary Tools

*** Spanish RAE Dictionary

=M-x org-scribe/rae-api-lookup= or press =F8 F8 d= in hydra

Looks up Spanish words in the Real Academia Española dictionary.

*** Synonyms

=M-x org-scribe/sinonimo= or press =F8 F8 y= in hydra

Opens WordReference Spanish synonyms in a side window.

** Capture Notes

=M-x org-scribe/capture-to-file= or press =C-c W=

Automatically finds the right notes file in your project structure.

*** Specialized Capture Functions

The package provides specialized capture templates for different types of content:

- =org-scribe/capture-character= (F8 F8 h) - Capture character profiles with comprehensive templates
- =org-scribe/capture-location= (F8 F8 l) - Capture location details for world building
- =org-scribe/capture-object= (F8 F8 b) - Capture important objects in your story
- =org-scribe/capture-timeline= (F8 F8 t) - Capture timeline events for chronology tracking
- =org-scribe/capture-plot-thread= (F8 F8 g) - Capture plot threads as they emerge during writing

These functions automatically route captures to the appropriate file based on project type:
- **Novel projects**: Separate files in =objects/= directory (e.g., =objects/characters.org=, =objects/plot.org=)
- **Short story projects**: Consolidated =notes.org= file with appropriate sections

All captured items automatically receive unique IDs for use with the linking system.

** Export with Scene Breaks

Add this macro to your org file:

#+begin_example
#+MACRO: scene-break SCENE-BREAK
#+end_example

Use ={{{scene-break}}}= where you want scene breaks.

When exporting, scene breaks will be replaced with appropriate separators for each backend (HTML, LaTeX, Markdown, etc.).

* Project Structure

=org-scribe= creates and works with structured novel projects:

#+begin_example
project-root/
├── .org-scribe-project    # Project marker file
├── README.org            # Project overview
├── novel.org             # Main manuscript with progress tracking (or novela.org for Spanish)
├── revision.org          # Revision tracking
├── writing-journal.org   # Reflective writing journal (or diario-escritura.org for Spanish)
├── objects/                 # Planning documents
│   ├── characters.org    # Character profiles
│   ├── locations.org     # World building
│   ├── plot.org         # Story structure
│   ├── timeline.org     # Chronology
│   └── objects.org      # Important items
└── notes/               # Notes and research
    ├── notes.org        # General notes
    └── research.org     # Research tracking
#+end_example

Projects can be created with =M-x org-scribe-create-novel-project= or the package works with any org-mode file structure.

* Configuration

See =M-x customize-group RET org-scribe RET= for all customization options.

Key variables:

** Project & Templates
- =org-scribe-template-directory= - Location of project templates (default: novel-en)
- =org-scribe-template-language= - Default language for templates ('en or 'es)
- =org-scribe-stories-directory= - Where writing exercise files are created

** Writing Modes
- =org-scribe-env-work-theme= - Theme for writing modes
- =org-scribe-env-normal-theme= - Normal theme
- =org-scribe-env-work-font= - Font preset for writing
- =org-scribe-env-work-width= - Writeroom width

** Export
- =org-scribe/scene-break-replacements= - Scene break strings for export backends

* Keybindings

Default keybindings when =org-scribe-mode= is active:

- =F8 F8= - Open hydra menu
- =C-c W= - Capture note

** Hydra Menu (F8 F8)

The hydra menu provides quick access to all functions organized into 6 columns:

*** Insert (Most Frequent Actions)
- =s= - Insert scene
- =c= - Insert chapter
- =o= - Open project file

*** Modes
- =m= - Writing mode (distraction-free)
- =p= - Project navigation mode
- =f= - Focus mode
- =e= - Editing mode

*** Capture
- =n= - Capture note
- =h= - Capture character
- =l= - Capture location
- =b= - Capture object
- =t= - Capture timeline event
- =g= - Capture plot thread

*** Tools
- =w= - Count words
- =r= - Update tracking table
- =a= - Add word count properties
- =d= - RAE dictionary
- =y= - Synonyms

*** Search (Numbered for Consistency)
- =1= - Find scenes by POV
- =2= - Find scenes with character
- =3= - Find scenes by plot
- =4= - Find scenes by location
- =5= - Find TODOs in project

*** Manage (Linking Submenus - Capitals Only)
- =C= - Character linking submenu
- =L= - Location linking submenu
- =P= - Plot thread linking submenu
- =U= - Update all link names (all types)

**** Character Linking Submenu (F8 F8 C)

*Character Linking:*
- =p= - Set PoV character
- =c= - Set scene characters
- =j= - Jump to PoV character
- =l= - Link current scene
- =L= - Link all scenes
- =i= - Add IDs to characters
- =u= - Update link names (current scene)
- =U= - Update all link names
- =s= - Setup linking system

*Relationships:*
- =a= - Add relationship
- =r= - Remove relationship
- =v= - View character relationships
- =V= - View all relationships
- =R= - Setup relationships

*Visualization:*
- =g= - Insert graph block

**** Location Linking Submenu (F8 F8 L)
- =c= - Set scene locations
- =l= - Link current scene
- =L= - Link all scenes
- =i= - Add IDs to locations
- =u= - Update link names (current scene)
- =U= - Update all link names
- =s= - Setup linking system

**** Plot Thread Linking Submenu (F8 F8 P)
- =p= - Set scene plot threads
- =j= - Jump to plot thread
- =l= - Link current scene
- =L= - Link all scenes
- =i= - Add IDs to threads
- =u= - Update link names (current scene)
- =U= - Update all link names
- =s= - Setup linking system
- =t= - Timeline table (insert instructions)
- =r= - Health report
- =S= - Statistics

* Contributing

Contributions are welcome! Please:

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Submit a pull request

* License

GPL-3.0-or-later

* Links

- Repository: https://codeberg.org/jcastp/org-scribe
- Issues: https://codeberg.org/jcastp/org-scribe/issues
- Dependencies: [[https://codeberg.org/jcastp/org-context-extended][org-context-extended]] (smart word counting)
- Dependencies: [[https://codeberg.org/jcastp/org-tracktable][org-tracktable]] (progress tracking)

* Acknowledgments

This package was developed for bilingual (English/Spanish) creative writing workflows. It integrates many excellent Emacs packages to provide a comprehensive writing environment.
